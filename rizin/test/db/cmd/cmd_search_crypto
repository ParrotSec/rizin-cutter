
NAME=search crypto AES256 expanded key (no overlap)
FILE=bins/other/aes.dump
CMDS=<<EOF
e search.overlap=false
/cmt
px @ hit.aes256.0 @!40
EOF
EXPECT=<<EOF
offset       size flag         detail 
--------------------------------------
  0x1e 0x00000020 hit.aes256.0 
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x0000001e  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x0000002e  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x0000003e  6263 6363 6263 6363                      bcccbccc
EOF
RUN

NAME=search crypto AES256 expanded key (overlap)
FILE=bins/other/aes.dump
CMDS=<<EOF
e search.overlap=true
/cmt
px @ hit.aes256.0 @!40
px @ hit.aes192.1 @!32
px @ hit.aes128.2 @!24
EOF
EXPECT=<<EOF
offset       size flag         detail 
--------------------------------------
  0x1e 0x00000020 hit.aes256.0 
  0x26 0x00000018 hit.aes192.1 
  0x2e 0x00000010 hit.aes128.2 
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x0000001e  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x0000002e  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x0000003e  6263 6363 6263 6363                      bcccbccc
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x00000026  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x00000036  0000 0000 0000 0000 6263 6363 6263 6363  ........bcccbccc
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x0000002e  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x0000003e  6263 6363 6263 6363                      bcccbccc
EOF
RUN

NAME=search crypto SM4 expanded key
FILE=bins/other/sm4_key_schedule.bin
CMDS=<<EOF
e search.overlap=true
/cmt
px @ hit.sm4.le.0 @!16
fC hit.sm4.le.0
EOF
EXPECT=<<EOF
offset       size flag         detail                           
----------------------------------------------------------------
  0xff 0x00000010 hit.sm4.le.0 0123456789abcdef123456789abcdef0
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x000000ff  f986 21f1 612b 6641 db28 e447 57db e32c  ..!.a+fA.(.GW..,
0123456789abcdef123456789abcdef0
EOF
RUN

NAME=search crypto AES192
FILE=bins/other/aes_192.dump
CMDS=<<EOF
e search.overlap=true
/cmt
px @ hit.aes192.0 @!0x18
EOF
EXPECT=<<EOF
offset       size flag         detail 
--------------------------------------
  0xfa 0x00000018 hit.aes192.0 
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x000000fa  0001 0203 0405 0607 0809 0a0b 0c0d 0e0f  ................
0x0000010a  1011 1213 1415 1617                      ........
EOF
RUN

NAME=search crypto rsa4096
FILE=bins/other/rsa-private-4096.key
CMDS=<<EOF
e search.overlap=true
/cmt
pFa @ hit.rsa.0 @!0x92c
EOF
EXPECT=<<EOF
offset       size flag      detail 
-----------------------------------
   0xd 0x0000092c hit.rsa.0 
   0  2344: 0: cons SEQUENCE            : 
   4     1: 1: prim INTEGER             : 00
   7   513: 1: prim INTEGER             : 00 c0 79 f2 4b 04 27 87 e4 89 6d b4 11 fa 76 47 |..y.K.'...m...vG|
                                        : e3 bb 62 c8 87 96 fa 97 9f 12 6c 57 5f 21 1e 80 |..b.......lW_!..|
                                        : ee da f8 01 cd e9 1a 39 79 08 39 58 88 d7 96 5c |.......9y.9X...\|
                                        : f4 3d 17 12 e4 f5 75 08 63 c7 a4 e1 39 1c e3 a5 |.=....u.c...9...|
                                        : 17 ce b2 c2 16 81 b1 79 92 fa 79 13 65 74 9b 2d |.......y..y.et.-|
                                        : d6 e9 8a 85 f6 37 8b 24 36 7e 46 90 8e 51 f0 8c |.....7.$6~F..Q..|
                                        : 64 93 db 49 e0 d9 36 9d 0c 35 3b 9f 47 fc 0e dc |d..I..6..5;.G...|
                                        : c9 02 33 34 b8 5a c7 19 63 49 f1 eb d7 ab d9 fb |..34.Z..cI......|
                                        : e8 f6 48 f5 fb 32 c2 f6 a3 99 8a 09 ea 84 59 18 |..H..2........Y.|
                                        : b3 04 48 b7 60 8b 2c 56 4d 71 73 79 23 00 e7 84 |..H.`.,VMqsy#...|
                                        : 43 69 a0 0c 0b c7 e5 8f 30 fc b8 b3 56 f3 f7 30 |Ci......0...V..0|
                                        : 1b 6b 01 03 28 4d 95 86 54 89 a3 d2 88 6b 9a 08 |.k..(M..T....k..|
                                        : b5 2f 29 e4 f9 e5 a2 e5 df 90 7f 0b f7 35 83 23 |./)..........5.#|
                                        : ca 69 b8 b2 5a a2 21 12 d2 14 35 d1 55 70 01 2d |.i..Z.!...5.Up.-|
                                        : f9 b0 6e 19 d2 3e 22 1e 8b 0c a6 b3 3e 0c 9c e2 |..n..>".....>...|
                                        : b3 d3 be 5a db 93 dd f7 37 7f 30 b2 16 0e a4 be |...Z....7.0.....|
                                        : ac c7 6e 0d 83 1d b4 91 77 a5 a8 59 03 74 4b 4f |..n.....w..Y.tKO|
                                        : 18 ef 2f 01 07 70 1b 41 ed 93 98 01 08 4a ca 78 |../..p.A.....J.x|
                                        : ff 08 25 38 a8 b8 e6 4a 34 4e db 4c 28 15 37 eb |..%8...J4N.L(.7.|
                                        : 26 d8 4d e9 36 57 dd f6 fd 33 b7 4b a9 0e a8 f3 |&.M.6W...3.K....|
                                        : 7b 9f bf c0 0b ee 16 7d 59 60 b7 f3 59 37 70 b5 |{......}Y`..Y7p.|
                                        : 71 7f 1a fe b2 0b 3a 0a c3 fa 7a 58 22 33 43 0e |q.....:...zX"3C.|
                                        : d4 bc 40 e2 e2 9e c0 f0 c2 8c ce ae 8b 26 a7 e4 |..@..........&..|
                                        : 0d fe 5b 7e f9 04 03 13 b9 07 66 f1 be 37 ce 48 |..[~......f..7.H|
                                        : 42 28 de f4 c6 fa 88 63 6e f0 51 25 21 c8 35 3f |B(.....cn.Q%!.5?|
                                        : d6 f9 9b 2e 09 c7 8e f6 7d c4 13 c0 1d 09 9e 94 |........}.......|
                                        : 2a 3c 2c 35 1e ad 9c bb fc 5e fb eb cc 43 02 f7 |*<,5.....^...C..|
                                        : 71 f3 2f 22 4b 84 2b 26 8d c4 48 cf 43 12 f5 1d |q./"K.+&..H.C...|
                                        : c0 2e 16 80 89 ba 9d 35 17 ef 00 a9 90 ae 20 48 |.......5...... H|
                                        : 64 31 4f 09 c7 6b 46 65 be b1 2b 9f bf 0c 41 9f |d1O..kFe..+...A.|
                                        : dc 08 00 58 ab 48 4c e1 54 87 3e 9a 56 3f e3 3c |...X.HL.T.>.V?.<|
                                        : 3c a9 ea 9d 00 3a f4 e9 56 6d 41 38 30 75 1c 57 |<....:..VmA80u.W|
                                        : 85                                              |.               |
 524     3: 1: prim INTEGER             : 010001
 529   513: 1: prim INTEGER             : 00 ad 93 cb db b6 ed 67 71 c4 35 f8 b4 55 e9 21 |.......gq.5..U.!|
                                        : 3f d0 97 6f 3c 47 fd c9 8a 9c f4 b3 7e 88 c1 97 |?..o<G......~...|
                                        : 88 d0 53 e4 5c ab a1 08 bf 8b 99 1b ac 9c af 6f |..S.\..........o|
                                        : 38 9b 77 19 84 fd 8f 03 77 e8 6d 5a e7 44 94 4f |8.w.....w.mZ.D.O|
                                        : 28 3f 31 9a 32 ed d6 fd 4a 7d 33 7f 38 79 86 10 |(?1.2...J}3.8y..|
                                        : 3a c5 f6 34 85 2c e6 00 4c 5c 68 8a a8 ae 60 7e |:..4.,..L\h...`~|
                                        : 5b 9d b3 9e d6 75 4c f9 28 2f 41 8b 8d 41 54 ad |[....uL.(/A..AT.|
                                        : eb 60 5e 89 66 d0 06 c9 70 6f 19 0a 95 3e d7 a0 |.`^.f...po...>..|
                                        : 84 20 c6 ff 7d ff f3 2e b5 af 1b 7b 81 d0 c5 00 |. ..}......{....|
                                        : af 40 67 cb 67 f7 5a 8e a1 dc 74 44 84 3a a6 8e |.@g.g.Z...tD.:..|
                                        : f2 b4 68 af 34 58 9b 3f 1c f0 6c 28 df 7b b8 29 |..h.4X.?..l(.{.)|
                                        : dc 30 0d 83 a9 6e fe 2f 5c 41 9c 49 9a d9 5e da |.0...n./\A.I..^.|
                                        : 07 7b 77 0e 96 06 6f 77 5a bc 56 b6 95 c3 de 76 |.{w...owZ.V....v|
                                        : 02 6e 81 2f e6 e8 5b 67 3b a9 1a 37 a4 13 14 1d |.n./..[g;..7....|
                                        : 40 15 c9 d4 e3 73 41 15 c6 54 2c 69 6c c5 b7 1e |@....sA..T,il...|
                                        : 03 0a 2b 9a 88 76 bb 2f dd 0e 88 fd b1 42 97 73 |..+..v./.....B.s|
                                        : 93 90 8c c5 3f a9 50 01 90 c5 21 1c 8d e7 1d fd |....?.P...!.....|
                                        : ac 26 02 a4 5a 53 e7 cf be 80 d7 93 e9 34 f0 5b |.&..ZS.......4.[|
                                        : db 89 9a 7b e8 f0 7e 18 19 00 48 f8 45 9c 6a 19 |...{..~...H.E.j.|
                                        : bf 6c 32 04 eb 82 8a 0f 7a 0c 54 db 91 e1 29 5c |.l2.....z.T...)\|
                                        : f4 c8 fe ef aa a6 1d c8 95 35 fe 40 79 1d d2 7c |.........5.@y..||
                                        : e8 6d b5 03 23 5a fa 5f 89 06 eb 3c 63 72 ae b2 |.m..#Z._...<cr..|
                                        : b6 bb 74 91 c0 9f a0 0a 6a 7b cc 45 1f 83 b3 7d |..t.....j{.E...}|
                                        : 1f 7d d1 79 63 9a 1d 37 9f fc 6c 5c bf 86 f4 ab |.}.yc..7..l\....|
                                        : c5 cc 9a 90 d9 9c b5 09 6f c1 17 03 cb 49 d2 13 |........o....I..|
                                        : e7 73 0c e2 90 7d 39 24 c2 03 d2 53 2e 3f 06 84 |.s...}9$...S.?..|
                                        : d9 70 ed 61 ad 90 9a c3 e5 51 21 95 b0 7a 9f aa |.p.a.....Q!..z..|
                                        : 0e 3d ac 64 4f 44 62 6b 51 a1 9e 28 f2 3a de 45 |.=.dODbkQ..(.:.E|
                                        : ed b7 a4 95 3a aa 38 1d 0d 32 54 4f 77 5f 71 b0 |....:.8..2TOw_q.|
                                        : 2f c7 8c ee da 77 00 7d ad 21 f6 dd 26 37 ef 88 |/....w.}.!..&7..|
                                        : 5c b1 7e 86 f3 44 01 ce 6c f4 1d 05 5e a6 3c 03 |\.~..D..l...^.<.|
                                        : fd 9c 4e 5e 9b 50 1c 49 26 15 27 b3 77 68 20 ee |..N^.P.I&.'.wh .|
                                        : 81                                              |.               |
1046   257: 1: prim INTEGER             : 00 e9 7b c6 d2 ff 46 90 1e fa 11 71 cb a6 92 5e |..{...F....q...^|
                                        : 0f 8d 68 c6 85 74 e3 49 98 48 2a 75 fd 42 8b 69 |..h..t.I.H*u.B.i|
                                        : 61 f0 77 71 c7 af 8e 41 05 2d 16 ff c4 8d 55 31 |a.wq...A.-....U1|
                                        : 8c a3 40 fa 5c 02 3f d5 a8 ae 4c 6d 48 0c ad e3 |..@.\.?...LmH...|
                                        : d0 4f 40 9f fa ed ee 1f cc 23 75 ab 3e c5 a3 d1 |.O@......#u.>...|
                                        : 87 a3 ed 85 96 9a 55 26 21 72 cb e8 09 c5 78 0a |......U&!r....x.|
                                        : e6 da d0 2f 0c da cb 07 8d 77 a4 14 6c 72 2a f8 |.../.....w..lr*.|
                                        : 7e 82 6d fe 9e 8f 7f db 7d f8 3b 1d 8e 13 f1 a4 |~.m.....}.;.....|
                                        : 82 d6 10 e6 07 85 4e 0c f7 95 2d 59 28 a4 e1 85 |......N...-Y(...|
                                        : 21 b8 9b 30 64 ac ff 2b 25 b3 5c 97 85 75 bc 46 |!..0d..+%.\..u.F|
                                        : e5 0b ae f5 3d c3 6b 9b f2 ec 54 51 ab e5 50 8f |....=.k...TQ..P.|
                                        : 3f 32 25 d0 19 2f d4 78 bf f6 4a d2 07 38 36 54 |?2%../.x..J..86T|
                                        : 3f 19 6d 6f 0a 8b aa d7 a6 7c 8f 26 f6 c6 f4 58 |?.mo.....|.&...X|
                                        : 0c 9e 67 02 11 6d d5 05 23 ad 79 60 4a 4d 33 cf |..g..m..#.y`JM3.|
                                        : 82 89 96 87 e3 f4 5f 5f 68 c2 d6 56 ca 40 2d d4 |......__h..V.@-.|
                                        : 7a d8 66 7c 17 5e 5f 53 80 a5 ce 0c f4 89 31 34 |z.f|.^_S......14|
                                        : 55                                              |U               |
1307   257: 1: prim INTEGER             : 00 d3 09 c9 d1 59 00 6a 25 d9 a4 76 4f 10 ad db |.....Y.j%..vO...|
                                        : b0 c0 94 23 37 a9 11 20 71 03 7f ae 1f f3 1c 4a |...#7.. q......J|
                                        : ff b6 dc 74 85 c2 f1 a7 73 c2 29 83 ac 68 d8 ef |...t....s.)..h..|
                                        : 64 97 9c 9c ce c7 c5 92 9d 98 24 96 15 45 d0 b0 |d.........$..E..|
                                        : a4 eb de 56 59 ba 33 c1 15 cc d7 74 d0 d3 3e 4d |...VY.3....t..>M|
                                        : 90 37 b1 2e 77 1c bb fe 2f 44 57 c4 85 9f 08 67 |.7..w.../DW....g|
                                        : 66 6f 1e 28 02 5b 48 66 57 8b 0a 5a b9 a1 5f 81 |fo.(.[HfW..Z.._.|
                                        : 78 22 1d 45 c5 00 dd e5 73 5c 1d 47 54 0c a9 5a |x".E....s\.GT..Z|
                                        : 01 86 3e 81 6d 82 09 a2 41 5b 79 6f 6c d7 b1 79 |..>.m...A[yol..y|
                                        : 04 c4 71 2a 6f 6f fd 30 cc c7 7c 59 8f be d4 ef |..q*oo.0..|Y....|
                                        : 75 7c 8e 2e dc 40 be 0d 6f e6 8d 8c 84 3f b8 eb |u|...@..o....?..|
                                        : 2c a5 d7 2e 05 7c 9f 73 06 7b 87 b1 91 cf 38 a7 |,....|.s.{....8.|
                                        : 94 7a 9f 5c ad 6f fe 66 ac 16 e9 92 48 56 47 4e |.z.\.o.f....HVGN|
                                        : 8b b5 77 f6 c4 c9 7a 66 b9 25 57 e5 90 6d b3 6e |..w...zf.%W..m.n|
                                        : 7d d1 7e aa 59 ba 6c 71 c5 15 aa 8e 27 6a 23 a4 |}.~.Y.lq....'j#.|
                                        : 0f d1 95 e4 73 b5 7d 6f a3 6b 79 d1 c2 06 c1 46 |....s.}o.ky....F|
                                        : 71                                              |q               |
1568   256: 1: prim INTEGER             : 66 53 5a d5 ca 0e f0 c6 c2 ad b6 83 9c 22 f5 9a |fSZ.........."..|
                                        : 37 4d 3e 03 eb 30 59 66 a5 ea 05 ff d2 94 2a c1 |7M>..0Yf......*.|
                                        : 43 93 f5 87 a0 46 e5 f4 10 c8 cd 9b 24 9d bb b3 |C....F......$...|
                                        : 79 30 d7 08 4f ec 0e 05 79 2e 01 8e dc 0f b1 91 |y0..O...y.......|
                                        : ef c9 d0 d3 36 47 70 24 15 3e 52 a8 96 11 af 98 |....6Gp$.>R.....|
                                        : 94 9d 5a 38 a0 b6 c4 99 50 28 51 2f 47 1d cf 19 |..Z8....P(Q/G...|
                                        : 51 b8 7f 86 50 b5 3e 40 1f b9 07 42 67 de b1 3d |Q...P.>@...Bg..=|
                                        : 30 88 68 58 b1 67 45 98 b5 9b a2 de 4b 9b 51 90 |0.hX.gE.....K.Q.|
                                        : 0d a5 26 4b 11 7f 1d 6b bc 33 3d a9 f4 68 e9 e1 |..&K...k.3=..h..|
                                        : d7 78 1c 03 63 56 09 60 e2 74 a7 eb 53 a8 0a 22 |.x..cV.`.t..S.."|
                                        : 03 b6 cf c0 1b cf 23 6f 99 67 72 cb b5 1a 53 4d |......#o.gr...SM|
                                        : 4c fb 09 72 a0 65 ab ed e5 50 f1 2f 3c d1 82 a6 |L..r.e...P./<...|
                                        : 8c cc 4b 28 02 02 03 b4 f1 4e 03 b3 8f 8a 32 b4 |..K(.....N....2.|
                                        : 85 0f 7b f6 8b 7e 1a 5c 82 80 79 54 d6 f4 e7 f2 |..{..~.\..yT....|
                                        : bb bd ff 1c 46 53 2e 0b 49 a8 8a 2c e5 67 b0 81 |....FS..I..,.g..|
                                        : 8e 29 8c 24 e9 b5 39 71 5e 39 29 b0 5a 17 f8 69 |.).$..9q^9).Z..i|
1828   256: 1: prim INTEGER             : 42 26 bc 53 5a 01 ae 44 45 0f af 62 23 49 4c 27 |B&.SZ..DE..b#IL'|
                                        : 00 86 ae ef 60 98 94 c1 b8 26 0a af cb 25 e0 40 |....`....&...%.@|
                                        : 7d d2 66 d8 12 fe 6a cd f7 5b ca 01 7e 30 1a 02 |}.f...j..[..~0..|
                                        : 3f 20 01 6b 33 e5 b3 8a a0 c9 3f 1e 55 ef 0f 9f |? .k3.....?.U...|
                                        : f2 ab 94 07 b6 3d 48 d6 0b 8a b1 fc 4f 6b 25 27 |.....=H.....Ok%'|
                                        : 02 be 10 61 97 e9 39 c9 19 34 25 ce f8 c5 ca 9b |...a..9..4%.....|
                                        : aa 53 1a 99 7a 81 9c 4a ee b3 85 32 d0 e9 be 0c |.S..z..J...2....|
                                        : a9 2c e1 d4 d9 eb b4 63 cf c9 01 b5 cf ee 39 df |.,.....c......9.|
                                        : 66 74 2b 5f e7 36 1b dd 3e ce 36 e6 38 4a 52 33 |ft+_.6..>.6.8JR3|
                                        : f3 5b c1 c0 82 ab 2b e3 d4 d8 1e be d7 43 a9 f7 |.[....+......C..|
                                        : fa de 1a c4 41 ab 11 4d 35 48 c3 76 24 ff 53 00 |....A..M5H.v$.S.|
                                        : 80 cf 8d 86 7c c5 02 6a 52 c8 7b 19 c8 89 ea c5 |....|..jR.{.....|
                                        : b9 16 41 17 c0 96 4f 1a bc 67 e4 c9 b5 f9 ce 1e |..A...O..g......|
                                        : 2e f8 f6 aa 42 b9 92 7f 90 bc 17 a2 89 30 88 7e |....B........0.~|
                                        : f9 ef 29 78 cc dd f7 5f 9e e6 02 7f 4a 5e f7 ab |..)x..._....J^..|
                                        : 59 b8 11 8f 4f a1 8d 1f fd ad 86 d9 ba 02 55 91 |Y...O.........U.|
2088   256: 1: prim INTEGER             : 59 ea 60 2e b7 01 f6 b1 e9 c4 97 32 db 52 9b 6b |Y.`........2.R.k|
                                        : 3f f5 28 0e ff 8e 7f 77 db 86 ec 02 2c a3 de 19 |?.(....w....,...|
                                        : 19 88 0e d9 3a 96 a5 b3 e7 a5 3a 6d 23 28 82 2b |....:.....:m#(.+|
                                        : a0 a6 06 ba 2c c6 95 d3 3c 23 ec 85 1d d0 f3 82 |....,...<#......|
                                        : dc a4 85 39 a1 8c a2 b3 06 77 b1 87 18 90 1c 04 |...9.....w......|
                                        : 1d 4d 74 c3 e9 64 3e cb 89 fc e8 1a 98 bc 97 52 |.Mt..d>........R|
                                        : 84 3d a8 9d 44 05 62 b2 87 da 2a 5a aa d5 e1 df |.=..D.b...*Z....|
                                        : 7c aa 2e ca c5 29 49 ca 90 66 13 90 90 ae 66 20 ||....)I..f....f |
                                        : 10 ac 10 e2 a7 0d 1b f7 74 d3 3d 4d 16 22 3e cb |........t.=M.">.|
                                        : 4f 3a 82 e0 dd 04 1c b1 1a 67 b2 0a cb 02 5e 6c |O:.......g....^l|
                                        : 75 7c dd cf c9 a2 40 74 51 bc 1a 55 19 3e ba b8 |u|....@tQ..U.>..|
                                        : 9a 26 39 a9 13 8b 13 b7 3f b5 2d 31 16 8f 65 f0 |.&9.....?.-1..e.|
                                        : bc ea a3 f3 5a 9e d7 23 51 76 c1 06 27 31 8c 63 |....Z..#Qv..'1.c|
                                        : cb 5d 79 1d 63 9a 63 53 63 c0 6c cb 83 44 88 ae |.]y.c.cSc.l..D..|
                                        : 83 c8 90 87 99 cf 05 01 f0 9b f1 55 78 75 a4 79 |...........Uxu.y|
                                        : 5a 57 6d 59 7f 04 3a b5 33 ca f7 97 03 b4 d1 21 |ZWmY..:.3......!|
EOF
RUN

NAME=search crypto ed448
FILE=bins/other/ed448-private.key
CMDS=<<EOF
e search.overlap=true
/cmt
pFa @ hit.safecurves.0 @!0x49
EOF
EXPECT=<<EOF
offset       size flag             detail 
------------------------------------------
  0xf5 0x00000049 hit.safecurves.0 
   0    71: 0: cons SEQUENCE            : 
   2     1: 1: prim INTEGER             : 00
   5     5: 1: cons SEQUENCE            : 
   7     3: 2: prim OBJECT_IDENTIFIER   : ed448
  12    59: 1: prim OCTET_STRING        : 
  14    57: 2: prim OCTET_STRING        : 17 64 49 16 8e c8 fc 66 d9 e6 7d 37 5d 1e a3 10 |.dI....f..}7]...|
                                        : b1 42 7e 8c 17 8b 2f 83 9c af 90 9b 0c a8 f6 55 |.B~.../........U|
                                        : 10 d1 f4 33 af d2 ce 6e 69 00 63 1a 0e 0b f4 38 |...3...ni.c....8|
                                        : 85 7c 56 d3 c7 97 8e 8b c9                      |.|V......       |
EOF
RUN

NAME=search crypto certificate
FILE=bins/other/certificate.ber
CMDS=<<EOF
e search.overlap=true
/cmt
pFx @ hit.x509.0 @!0x34d
EOF
EXPECT=<<EOF
offset       size flag       detail 
------------------------------------
  0x2f 0x0000034d hit.x509.0 
TBSCertificate:
  Version: v3
  Serial Number:
    53:2a:e3:b1:e9:ef:4e:87:2a:ea:c3:5b:32:8f:7d:95:71:16:bd:39
  Signature Algorithm:
    sha256WithRSAEncryption
  Issuer:
    countryName: ZA
    stateOrProvinceName: Some-State
    organizationName: Radare2
  Validity:
    Not Before: 27/11/2019 18:09:20 GMT
    Not After: 26/11/2020 18:09:20 GMT
  Subject:
    countryName: ZA
    stateOrProvinceName: Some-State
    organizationName: Radare2
  Subject Public Key Info:
    Algorithm: rsaEncryption
    Module: 01:00:01
    Exponent: 256 bytes
  Extensions:
    subjectKeyIdentifier: 
    22 bytes
    authorityKeyIdentifier: 
    24 bytes
    basicConstraints: critical
    5 bytes
Algorithm:
  sha256WithRSAEncryption
Signature: 256 bytes
EOF
RUN
